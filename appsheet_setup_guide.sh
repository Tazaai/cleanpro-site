#!/bin/bash

echo "ğŸ“Š APPSHEET INTEGRATION SETUP GUIDE"
echo "==================================="
echo ""

echo "ğŸ“‹ APPSHEET INTEGRATION OVERVIEW:"
echo "================================="
echo "AppSheet enables non-technical admin management of:"
echo "ğŸ¢ Coordination Points (locations, contacts, service areas)"
echo "ğŸ’° Pricing Structure (rates, discounts, distance fees)"
echo "ğŸ“Š Booking Management (external business workflows)"
echo ""

echo "ğŸ”§ REQUIRED GITHUB SECRETS:"
echo "=========================="
echo "1. ğŸ”‘ APPSHEET_API_KEY - Your AppSheet API access key"
echo "2. ğŸ“± APPSHEET_APP_ID - Your specific app identifier"
echo ""

echo "ğŸ“¥ HOW TO GET APPSHEET CREDENTIALS:"
echo "=================================="
echo "1. ğŸŒ Go to: https://www.appsheet.com/"
echo "2. ğŸ“± Create/access your Clean Departure management app"
echo "3. âš™ï¸ Go to App Settings â†’ Security"
echo "4. ğŸ”‘ Generate API key if not already done"
echo "5. ğŸ“‹ Copy the API key and App ID"
echo ""

echo "ğŸ—ï¸ APPSHEET APP STRUCTURE NEEDED:"
echo "================================="
echo "Your AppSheet app should have these tables:"
echo ""
echo "ğŸ“Š Table 1: CoordinationPoints"
echo "  - name (Text)"
echo "  - address (LongText)"
echo "  - city (Text)"
echo "  - state (Text)"
echo "  - phone (Phone)"
echo "  - email (Email)"
echo "  - active (Yes/No)"
echo "  - latitude (Decimal)"
echo "  - longitude (Decimal)"
echo "  - serviceRadius (Number)"
echo ""
echo "ğŸ’° Table 2: Pricing"
echo "  - service_id (Text)"
echo "  - service_name (Text)"
echo "  - price_per_sqft (Decimal)"
echo "  - weekly_discount (Percent)"
echo "  - monthly_discount (Percent)"
echo "  - distance_fee_per_mile (Decimal)"
echo "  - free_distance_miles (Number)"
echo ""
echo "ğŸ“… Table 3: Bookings (Optional)"
echo "  - booking_id (Text)"
echo "  - customer_email (Email)"
echo "  - service_type (Text)"
echo "  - square_feet (Number)"
echo "  - total_price (Price)"
echo "  - booking_date (Date)"
echo "  - status (Enum: pending, confirmed, completed)"
echo ""

echo "ğŸ”§ HOW TO ADD SECRETS TO GITHUB:"
echo "================================"
echo "1. ğŸŒ Go to: https://github.com/Tazaai/cleanpro-site/settings/secrets/actions"
echo "2. â• Click 'New repository secret'"
echo "3. ğŸ“ Name: APPSHEET_API_KEY"
echo "4. ğŸ“‹ Value: [Your AppSheet API key]"
echo "5. ğŸ’¾ Click 'Add secret'"
echo "6. ğŸ” Repeat for APPSHEET_APP_ID"
echo ""

echo "ğŸ§ª TEST APPSHEET INTEGRATION:"
echo "============================="
echo "After adding secrets, test with:"
echo "curl -s 'https://cleanpro-backend-2a5pka5baa-ew.a.run.app/api/appsheet/config'"
echo ""
echo "Expected response:"
echo "{"
echo '  "ok": true,'
echo '  "configured": true,'
echo '  "hasApiKey": true,'
echo '  "hasAppId": true'
echo "}"
echo ""

echo "ğŸ”— APPSHEET API ENDPOINTS:"
echo "========================="
echo "Once configured, these endpoints will be available:"
echo "ğŸ“Š GET  /api/appsheet/config - Check configuration"
echo "ğŸ§ª POST /api/appsheet/test - Test connection"
echo "ğŸ”„ POST /api/appsheet/sync/coordination-points - Sync coordination points"
echo "ğŸ’° POST /api/appsheet/sync/pricing - Sync pricing data"
echo "ğŸ“Š POST /api/appsheet/sync/all - Sync all data"
echo "ğŸ“… POST /api/appsheet/push/booking/:id - Push booking to AppSheet"
echo ""

echo "ğŸš€ DEPLOYMENT SEQUENCE:"
echo "======================"
echo "1. ğŸ”¥ Fix Firebase connection first"
echo "2. ğŸ“Š Add AppSheet secrets to GitHub"
echo "3. ğŸš€ Deploy updated backend"
echo "4. ğŸ§ª Test both Firebase and AppSheet connectivity"
echo "5. ğŸ”„ Enable real two-way data sync"
echo ""

echo "âš ï¸ IMPORTANT NOTES:"
echo "=================="
echo "âœ… AppSheet integration requires Firebase to be working first"
echo "âœ… Data will sync bidirectionally (AppSheet â†” Firestore)"
echo "âœ… Admin users can manage business data through AppSheet UI"
echo "âŒ Don't configure AppSheet until Firebase connection is fixed"